# Workflow åº“é€‰å‹ç»“è®º

## ğŸ† æœ€ç»ˆæ¨èï¼šReact Flow

### æ ¸å¿ƒç†ç”±

1. **æŠ€æœ¯æ ˆå®Œç¾å¥‘åˆ**
   - é¡¹ç›®ä½¿ç”¨ React + TypeScript + Zustand
   - React Flow å†…éƒ¨ä¹Ÿä½¿ç”¨ Zustand
   - æ— ç¼é›†æˆï¼Œé›¶é¢å¤–å­¦ä¹ æˆæœ¬

2. **å¼€å‘æ•ˆç‡æœ€é«˜**
   - API è®¾è®¡ä¼˜é›…ç›´è§‚
   - æ–‡æ¡£å®Œå–„ï¼Œç¤ºä¾‹ä¸°å¯Œ
   - ç¤¾åŒºæ´»è·ƒï¼ˆ20k+ starsï¼‰
   - å¼€ç®±å³ç”¨åŠŸèƒ½å®Œæ•´

3. **åŠŸèƒ½å®Œæ•´æ€§**
   - âœ… è‡ªå®šä¹‰èŠ‚ç‚¹å’Œè¾¹
   - âœ… æ‹–æ‹½ã€ç¼©æ”¾ã€å¹³ç§»
   - âœ… Mini Mapã€Controls
   - âœ… æ’¤é”€/é‡åš
   - âœ… æ’ä»¶ç³»ç»Ÿ
   - âœ… TypeScript å®Œæ•´æ”¯æŒ

4. **æ€§èƒ½ä¼˜ç§€**
   - è™šæ‹ŸåŒ–æ¸²æŸ“
   - æ”¯æŒ 100-1000 èŠ‚ç‚¹
   - æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆæˆç†Ÿ

5. **æˆæœ¬å¯æ§**
   - MIT è®¸å¯è¯
   - åŸºç¡€åŠŸèƒ½å®Œå…¨å…è´¹
   - å¤§éƒ¨åˆ†ä¸šåŠ¡åœºæ™¯ä¸éœ€è¦ Pro ç‰ˆæœ¬

---

## å¯¹æ¯”æ€»ç»“

| ç»´åº¦ | React Flow | jsPlumb | Mermaid | G6 | ç»“è®º |
|------|-----------|---------|---------|----|----|
| React é›†æˆ | â­â­â­â­â­ | â­â­â­ | â­â­â­ | â­â­â­ | **React Flow æœ€ä¼˜** |
| æ˜“ç”¨æ€§ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­ | **React Flow å¹³è¡¡æœ€å¥½** |
| äº¤äº’èƒ½åŠ› | â­â­â­â­â­ | â­â­â­â­ | âŒ | â­â­â­â­ | **React Flow æœ€å¼º** |
| æ€§èƒ½ | â­â­â­â­â­ | â­â­â­ | â­â­â­ | â­â­â­â­â­ | **ä¸­ç­‰è§„æ¨¡ React Flow è¶³å¤Ÿ** |
| æ–‡æ¡£è´¨é‡ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | **React Flow æœ€å®Œå–„** |
| ç¤¾åŒºæ´»è·ƒåº¦ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | **React Flow æŒç»­æ›´æ–°** |

---

## å®æ–½è·¯çº¿å›¾

### é˜¶æ®µä¸€ï¼šåŸºç¡€æ­å»ºï¼ˆç¬¬ 1-2 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå®ŒæˆåŸºç¡€ Workflow ç»„ä»¶å°è£…

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] åˆ›å»º WorkflowEditor åŸºç¡€ç»„ä»¶
- [ ] å°è£…å¸¸ç”¨èŠ‚ç‚¹ç±»å‹ï¼ˆå¼€å§‹ã€ç»“æŸã€å¤„ç†ã€åˆ¤æ–­ï¼‰
- [ ] å®ç°èŠ‚ç‚¹æ‹–æ‹½å’Œè¿çº¿
- [ ] æ·»åŠ å·¥å…·æ ï¼ˆControlsã€MiniMapï¼‰
- [ ] å®ç°åŸºç¡€æ ·å¼å®šåˆ¶

**äº¤ä»˜ç‰©**ï¼š
- å¯è¿è¡Œçš„ Workflow ç¼–è¾‘å™¨ Demo
- åŸºç¡€èŠ‚ç‚¹åº“
- ä½¿ç”¨æ–‡æ¡£

---

### é˜¶æ®µäºŒï¼šä¸šåŠ¡é›†æˆï¼ˆç¬¬ 3-4 å‘¨ï¼‰

**ç›®æ ‡**ï¼šé›†æˆä¸šåŠ¡é€»è¾‘å’Œæ•°æ®æŒä¹…åŒ–

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] å®šä¹‰ä¸šåŠ¡èŠ‚ç‚¹æ•°æ®ç»“æ„
- [ ] å®ç°èŠ‚ç‚¹é…ç½®é¢æ¿
- [ ] é›†æˆ Zustand çŠ¶æ€ç®¡ç†
- [ ] å®ç°æ•°æ®ä¿å­˜å’ŒåŠ è½½ï¼ˆAPI é›†æˆï¼‰
- [ ] æ·»åŠ èŠ‚ç‚¹éªŒè¯é€»è¾‘
- [ ] å®ç°èŠ‚ç‚¹æœç´¢åŠŸèƒ½

**äº¤ä»˜ç‰©**ï¼š
- å®Œæ•´çš„ä¸šåŠ¡ Workflow ç»„ä»¶
- æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ
- API æ¥å£æ–‡æ¡£

---

### é˜¶æ®µä¸‰ï¼šé«˜çº§åŠŸèƒ½ï¼ˆç¬¬ 5-6 å‘¨ï¼‰

**ç›®æ ‡**ï¼šæå‡ç”¨æˆ·ä½“éªŒå’ŒåŠŸèƒ½å®Œæ•´æ€§

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] å®ç°æ’¤é”€/é‡åšåŠŸèƒ½
- [ ] æ·»åŠ å¿«æ·é”®æ”¯æŒ
- [ ] å®ç°èŠ‚ç‚¹å¤åˆ¶/ç²˜è´´
- [ ] æ·»åŠ èŠ‚ç‚¹åˆ†ç»„åŠŸèƒ½
- [ ] å®ç°è‡ªåŠ¨å¸ƒå±€ï¼ˆé›†æˆ Dagreï¼‰
- [ ] æ·»åŠ å¯¼å‡ºåŠŸèƒ½ï¼ˆJSONã€å›¾ç‰‡ï¼‰

**äº¤ä»˜ç‰©**ï¼š
- åŠŸèƒ½å®Œæ•´çš„ Workflow ç³»ç»Ÿ
- å¿«æ·é”®æ–‡æ¡£
- å¯¼å‡ºåŠŸèƒ½

---

### é˜¶æ®µå››ï¼šä¼˜åŒ–å’Œå®Œå–„ï¼ˆæŒç»­ï¼‰

**ç›®æ ‡**ï¼šæ€§èƒ½ä¼˜åŒ–å’Œç”¨æˆ·ä½“éªŒæå‡

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–
- [ ] å¤§è§„æ¨¡èŠ‚ç‚¹ä¼˜åŒ–ï¼ˆè™šæ‹ŸåŒ–ï¼‰
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- [ ] å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- [ ] ç»„ä»¶æ–‡æ¡£å®Œå–„
- [ ] ç¤ºä¾‹å’Œæœ€ä½³å®è·µ

**äº¤ä»˜ç‰©**ï¼š
- æ€§èƒ½ä¼˜åŒ–æŠ¥å‘Š
- æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
- å®Œæ•´çš„ç»„ä»¶æ–‡æ¡£

---

## æŠ€æœ¯æ¶æ„å»ºè®®

### ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ Workflow/
â”‚       â”œâ”€â”€ index.tsx                 # ä¸»ç»„ä»¶
â”‚       â”œâ”€â”€ WorkflowEditor.tsx        # ç¼–è¾‘å™¨ç»„ä»¶
â”‚       â”œâ”€â”€ nodes/                    # èŠ‚ç‚¹ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ StartNode.tsx
â”‚       â”‚   â”œâ”€â”€ EndNode.tsx
â”‚       â”‚   â”œâ”€â”€ ProcessNode.tsx
â”‚       â”‚   â””â”€â”€ DecisionNode.tsx
â”‚       â”œâ”€â”€ edges/                    # è¾¹ç»„ä»¶
â”‚       â”‚   â””â”€â”€ CustomEdge.tsx
â”‚       â”œâ”€â”€ panels/                   # é¢æ¿ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ NodePanel.tsx         # èŠ‚ç‚¹é…ç½®é¢æ¿
â”‚       â”‚   â””â”€â”€ ToolbarPanel.tsx      # å·¥å…·æ 
â”‚       â”œâ”€â”€ hooks/                    # è‡ªå®šä¹‰ Hooks
â”‚       â”‚   â”œâ”€â”€ useWorkflow.ts
â”‚       â”‚   â””â”€â”€ useNodeValidation.ts
â”‚       â””â”€â”€ styles/                   # æ ·å¼æ–‡ä»¶
â”‚           â””â”€â”€ workflow.scss
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ workflowStore.ts              # Workflow çŠ¶æ€ç®¡ç†
â”œâ”€â”€ types/
â”‚   â””â”€â”€ workflow.ts                   # ç±»å‹å®šä¹‰
â””â”€â”€ utils/
    â””â”€â”€ workflowUtils.ts              # å·¥å…·å‡½æ•°
```

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

```typescript
// æ ¸å¿ƒä¾èµ–
{
  "reactflow": "^11.11.4",           // Workflow æ ¸å¿ƒåº“
  "zustand": "^5.0.9",               // çŠ¶æ€ç®¡ç†ï¼ˆå·²å®‰è£…ï¼‰
  "lucide-react": "^0.562.0",        // å›¾æ ‡åº“ï¼ˆå·²å®‰è£…ï¼‰
  "@tanstack/react-query": "^5.90.12", // æ•°æ®æŸ¥è¯¢ï¼ˆå·²å®‰è£…ï¼‰
  "axios": "^1.13.2"                 // HTTP è¯·æ±‚ï¼ˆå·²å®‰è£…ï¼‰
}

// å¯é€‰ä¾èµ–
{
  "dagre": "^0.8.5",                 // è‡ªåŠ¨å¸ƒå±€ç®—æ³•
  "html-to-image": "^1.11.11",       // å¯¼å‡ºå›¾ç‰‡
  "file-saver": "^2.0.5"             // æ–‡ä»¶ä¿å­˜
}
```

---

## å…³é”®ä»£ç ç¤ºä¾‹

### 1. åŸºç¡€ Workflow ç»„ä»¶

```typescript
// src/components/Workflow/WorkflowEditor.tsx
import ReactFlow, {
  Node,
  Edge,
  Controls,
  Background,
  MiniMap,
  useNodesState,
  useEdgesState,
  addEdge,
  Connection,
} from 'reactflow';
import 'reactflow/dist/style.css';

interface WorkflowEditorProps {
  initialNodes?: Node[];
  initialEdges?: Edge[];
  onSave?: (nodes: Node[], edges: Edge[]) => void;
}

export const WorkflowEditor: React.FC<WorkflowEditorProps> = ({
  initialNodes = [],
  initialEdges = [],
  onSave,
}) => {
  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);
  const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);

  const onConnect = (connection: Connection) => {
    setEdges(eds => addEdge(connection, eds));
  };

  const handleSave = () => {
    onSave?.(nodes, edges);
  };

  return (
    <div style={{ width: '100%', height: '100vh' }}>
      <ReactFlow
        nodes={nodes}
        edges={edges}
        onNodesChange={onNodesChange}
        onEdgesChange={onEdgesChange}
        onConnect={onConnect}
        fitView
      >
        <Controls />
        <MiniMap />
        <Background />
      </ReactFlow>
      <button onClick={handleSave}>ä¿å­˜</button>
    </div>
  );
};
```

### 2. è‡ªå®šä¹‰èŠ‚ç‚¹

```typescript
// src/components/Workflow/nodes/ProcessNode.tsx
import { Handle, Position } from 'reactflow';
import { Settings } from 'lucide-react';

interface ProcessNodeData {
  label: string;
  description?: string;
}

export const ProcessNode: React.FC<{ data: ProcessNodeData }> = ({ data }) => {
  return (
    <div className="process-node">
      <Handle type="target" position={Position.Top} />
      <div className="node-header">
        <Settings size={16} />
        <span>{data.label}</span>
      </div>
      {data.description && (
        <div className="node-description">{data.description}</div>
      )}
      <Handle type="source" position={Position.Bottom} />
    </div>
  );
};
```

### 3. Zustand Store

```typescript
// src/stores/workflowStore.ts
import { create } from 'zustand';
import { Node, Edge } from 'reactflow';

interface WorkflowState {
  nodes: Node[];
  edges: Edge[];
  selectedNode: Node | null;
  setNodes: (nodes: Node[]) => void;
  setEdges: (edges: Edge[]) => void;
  setSelectedNode: (node: Node | null) => void;
  addNode: (node: Node) => void;
  removeNode: (nodeId: string) => void;
  updateNode: (nodeId: string, data: Partial<Node>) => void;
}

export const useWorkflowStore = create<WorkflowState>(set => ({
  nodes: [],
  edges: [],
  selectedNode: null,
  setNodes: nodes => set({ nodes }),
  setEdges: edges => set({ edges }),
  setSelectedNode: selectedNode => set({ selectedNode }),
  addNode: node => set(state => ({ nodes: [...state.nodes, node] })),
  removeNode: nodeId =>
    set(state => ({
      nodes: state.nodes.filter(n => n.id !== nodeId),
      edges: state.edges.filter(e => e.source !== nodeId && e.target !== nodeId),
    })),
  updateNode: (nodeId, data) =>
    set(state => ({
      nodes: state.nodes.map(n => (n.id === nodeId ? { ...n, ...data } : n)),
    })),
}));
```

---

## é£é™©è¯„ä¼°ä¸åº”å¯¹

### é£é™© 1ï¼šæ€§èƒ½é—®é¢˜ï¼ˆä¸­ç­‰é£é™©ï¼‰

**åœºæ™¯**ï¼šèŠ‚ç‚¹æ•°é‡è¶…è¿‡ 1000 æ—¶æ€§èƒ½ä¸‹é™

**åº”å¯¹æ–¹æ¡ˆ**ï¼š
- å®ç°è™šæ‹ŸåŒ–æ¸²æŸ“
- åˆ†é¡µåŠ è½½
- ä½¿ç”¨ React.memo ä¼˜åŒ–ç»„ä»¶
- è€ƒè™‘åˆ‡æ¢åˆ° Canvas æ¸²æŸ“ï¼ˆG6ï¼‰

### é£é™© 2ï¼šåŠŸèƒ½é™åˆ¶ï¼ˆä½é£é™©ï¼‰

**åœºæ™¯**ï¼šéœ€è¦ Pro ç‰ˆæœ¬åŠŸèƒ½

**åº”å¯¹æ–¹æ¡ˆ**ï¼š
- è¯„ä¼°æ˜¯å¦çœŸæ­£éœ€è¦
- è€ƒè™‘è‡ªè¡Œå®ç°
- è´­ä¹° Pro è®¸å¯è¯ï¼ˆæˆæœ¬å¯æ§ï¼‰

### é£é™© 3ï¼šå­¦ä¹ æˆæœ¬ï¼ˆä½é£é™©ï¼‰

**åœºæ™¯**ï¼šå›¢é˜Ÿä¸ç†Ÿæ‚‰ React Flow

**åº”å¯¹æ–¹æ¡ˆ**ï¼š
- æä¾›åŸ¹è®­å’Œæ–‡æ¡£
- åˆ›å»ºç¤ºä¾‹å’Œæœ€ä½³å®è·µ
- é€æ­¥è¿ç§»ï¼Œé™ä½é£é™©

---

## æˆåŠŸæŒ‡æ ‡

### æŠ€æœ¯æŒ‡æ ‡
- âœ… æ”¯æŒ 100+ èŠ‚ç‚¹æµç•…è¿è¡Œ
- âœ… é¡µé¢åŠ è½½æ—¶é—´ < 2s
- âœ… äº¤äº’å“åº”æ—¶é—´ < 100ms
- âœ… ä»£ç æµ‹è¯•è¦†ç›–ç‡ > 80%

### ä¸šåŠ¡æŒ‡æ ‡
- âœ… ç”¨æˆ·å¯åœ¨ 5 åˆ†é’Ÿå†…åˆ›å»ºåŸºç¡€æµç¨‹
- âœ… æµç¨‹ä¿å­˜æˆåŠŸç‡ > 99%
- âœ… ç”¨æˆ·æ»¡æ„åº¦ > 4.5/5

### å¼€å‘æŒ‡æ ‡
- âœ… ç»„ä»¶å¤ç”¨ç‡ > 70%
- âœ… Bug ä¿®å¤æ—¶é—´ < 2 å¤©
- âœ… æ–°åŠŸèƒ½å¼€å‘å‘¨æœŸ < 1 å‘¨

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œï¼ˆæœ¬å‘¨ï¼‰
1. âœ… ç¡®è®¤ React Flow ä½œä¸ºæŠ€æœ¯é€‰å‹
2. â¬œ åˆ›å»º Workflow ç»„ä»¶ç›®å½•ç»“æ„
3. â¬œ å®ç°åŸºç¡€ WorkflowEditor ç»„ä»¶
4. â¬œ åˆ›å»ºç¬¬ä¸€ä¸ªè‡ªå®šä¹‰èŠ‚ç‚¹

### çŸ­æœŸè®¡åˆ’ï¼ˆ2 å‘¨å†…ï¼‰
1. â¬œ å®ŒæˆåŸºç¡€èŠ‚ç‚¹åº“ï¼ˆå¼€å§‹ã€ç»“æŸã€å¤„ç†ã€åˆ¤æ–­ï¼‰
2. â¬œ å®ç°èŠ‚ç‚¹æ‹–æ‹½å’Œè¿çº¿
3. â¬œ æ·»åŠ å·¥å…·æ å’Œ MiniMap
4. â¬œ é›†æˆ Zustand çŠ¶æ€ç®¡ç†

### ä¸­æœŸè®¡åˆ’ï¼ˆ1 ä¸ªæœˆå†…ï¼‰
1. â¬œ å®ç°èŠ‚ç‚¹é…ç½®é¢æ¿
2. â¬œ é›†æˆæ•°æ®æŒä¹…åŒ–
3. â¬œ æ·»åŠ èŠ‚ç‚¹éªŒè¯é€»è¾‘
4. â¬œ å®ç°æ’¤é”€/é‡åšåŠŸèƒ½

---

## å‚è€ƒèµ„æº

### å®˜æ–¹èµ„æº
- React Flow å®˜æ–¹æ–‡æ¡£: https://reactflow.dev/
- React Flow ç¤ºä¾‹: https://reactflow.dev/examples
- React Flow GitHub: https://github.com/xyflow/xyflow

### å­¦ä¹ èµ„æº
- React Flow å¿«é€Ÿå…¥é—¨: https://reactflow.dev/learn
- React Flow API æ–‡æ¡£: https://reactflow.dev/api-reference
- React Flow Discord ç¤¾åŒº: https://discord.gg/Bqt6xrs

### ç›¸å…³é¡¹ç›®
- n8n (å·¥ä½œæµè‡ªåŠ¨åŒ–): https://github.com/n8n-io/n8n
- Temporal (å·¥ä½œæµå¼•æ“): https://github.com/temporalio/ui

---

## æ€»ç»“

**React Flow æ˜¯å½“å‰æœ€é€‚åˆé¡¹ç›®çš„ Workflow åº“é€‰æ‹©**ï¼Œç†ç”±å¦‚ä¸‹ï¼š

1. âœ… ä¸ç°æœ‰æŠ€æœ¯æ ˆå®Œç¾å¥‘åˆï¼ˆReact + TypeScript + Zustandï¼‰
2. âœ… å¼€å‘æ•ˆç‡é«˜ï¼Œå­¦ä¹ æˆæœ¬é€‚ä¸­
3. âœ… åŠŸèƒ½å®Œæ•´ï¼Œæ»¡è¶³ä¸šåŠ¡éœ€æ±‚
4. âœ… æ€§èƒ½ä¼˜ç§€ï¼Œæ”¯æŒä¸­ç­‰è§„æ¨¡èŠ‚ç‚¹
5. âœ… ç¤¾åŒºæ´»è·ƒï¼Œé•¿æœŸç»´æŠ¤æœ‰ä¿éšœ
6. âœ… æˆæœ¬å¯æ§ï¼ŒMIT è®¸å¯è¯

**å»ºè®®ç«‹å³å¼€å§‹åŸºäº React Flow çš„ Workflow ç»„ä»¶å¼€å‘ã€‚**

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**ç”Ÿæˆæ—¥æœŸ**: 2025-12-22
**ä¸‹æ¬¡è¯„å®¡**: 2025-03-22ï¼ˆ3 ä¸ªæœˆåï¼‰
