JSON Schema 是一种基于 JSON 格式的声明性语言，用于描述、验证 JSON 数据的结构和约束。它在 API 测试、表单生成、配置文件验证等场景中非常通用。

以下是标准 JSON Schema 中核心字段的含义、用法及使用场景的详细分类解释：

---

### 1. 元数据关键字 (Meta-schema)

这些字段用于描述 Schema 本身，而不是被验证的数据。

| 字段              | 含义                                                  | 使用场景                                                  |
| :---------------- | :---------------------------------------------------- | :-------------------------------------------------------- |
| **`$schema`**     | 声明使用的 JSON Schema 版本（如 draft-07, 2020-12）。 | **版本控制**：告诉验证器用哪套规则来解析这个文件。        |
| **`$id`**         | Schema 的唯一标识符（通常是一个 URI）。               | **引用解析**：当其他 Schema 需要引用此 Schema 时使用。    |
| **`title`**       | Schema 的简短名称。                                   | **文档生成**：用于生成 API 文档的标题或前端表单的 Label。 |
| **`description`** | 详细说明。                                            | **文档/提示**：用于生成 Tooltip 或帮助文本。              |
| **`default`**     | 默认值。                                              | **表单填充**：如果数据缺失，前端可以使用此值预填充。      |
| **`examples`**    | 示例数据列表。                                        | **Mock 数据**：用于生成模拟数据或展示示例。               |

---

### 2. 通用验证关键字

适用于任何类型的字段。

| 字段        | 含义                                                                                        | 使用场景                                                          |
| :---------- | :------------------------------------------------------------------------------------------ | :---------------------------------------------------------------- |
| **`type`**  | 指定数据类型。可选值：`string`, `number`, `integer`, `object`, `array`, `boolean`, `null`。 | **基础类型检查**：确保传进来的是数字而不是字符串。                |
| **`enum`**  | 枚举，值必须是列表中的一个。                                                                | **下拉菜单**：限制状态（如 `["active", "inactive"]`）或国家代码。 |
| **`const`** | 常量，值必须完全匹配。                                                                      | **固定参数**：如协议版本号必须是 `v1`。                           |

---

### 3. 字符串 (String) 相关

当 `type: "string"` 时使用的约束。

| 字段                              | 含义                                                                    | 使用场景                                                         |
| :-------------------------------- | :---------------------------------------------------------------------- | :--------------------------------------------------------------- |
| **`minLength`** / **`maxLength`** | 最小/最大长度。                                                         | **输入限制**：用户名长度限制（如 6-20 字符）。                   |
| **`pattern`**                     | 正则表达式。                                                            | **格式校验**：手机号、身份证号、自定义编码规则。                 |
| **`format`**                      | 预定义的语义格式。常见值：`date-time`, `email`, `ipv4`, `uri`, `uuid`。 | **语义校验**：验证是否为合法的邮箱地址或日期时间，无需手写正则。 |

---

### 4. 数值 (Number/Integer) 相关

当 `type: "number"` 或 `"integer"` 时使用的约束。

| 字段                                            | 含义                        | 使用场景                                                    |
| :---------------------------------------------- | :-------------------------- | :---------------------------------------------------------- |
| **`minimum`** / **`maximum`**                   | 最小值/最大值（包含边界）。 | **范围限制**：年龄必须在 0 到 120 之间。                    |
| **`exclusiveMinimum`** / **`exclusiveMaximum`** | 不包含边界的极值。          | **数学区间**：如 `x > 0`。                                  |
| **`multipleOf`**                                | 必须是该值的倍数。          | **精度控制**：货币金额（0.01 的倍数）或时间步长（15分钟）。 |

---

### 5. 对象 (Object) 相关

当 `type: "object"` 时使用的约束，这是定义复杂结构的核心。

| 字段                                        | 含义                                                      | 使用场景                                                               |
| :------------------------------------------ | :-------------------------------------------------------- | :--------------------------------------------------------------------- |
| **`properties`**                            | 定义对象中每个字段的 Schema。                             | **结构定义**：定义 `user` 对象包含 `name` 和 `age`。                   |
| **`required`**                              | 必须存在的字段名列表（数组）。                            | **必填项检查**：注册时 `email` 和 `password` 必填。                    |
| **`additionalProperties`**                  | 布尔值或 Schema。若为 `false`，则不允许出现未定义的字段。 | **严格模式**：防止 API 接收未知参数（通常设为 false 以保证数据纯净）。 |
| **`patternProperties`**                     | 使用正则匹配属性名。                                      | **动态键名**：如 CSS 类名验证，或键名是 UUID 的字典结构。              |
| **`minProperties`** / **`maxProperties`**   | 属性数量限制。                                            | **容量限制**：限制上传的元数据标签数量。                               |
| **`dependencies`** (或 `dependentRequired`) | 字段间的依赖关系。                                        | **逻辑依赖**：如果填了 `credit_card`，则必须填 `cvv`。                 |

---

### 6. 数组 (Array) 相关

当 `type: "array"` 时使用的约束。

| 字段                            | 含义                                                                           | 使用场景                                                               |
| :------------------------------ | :----------------------------------------------------------------------------- | :--------------------------------------------------------------------- |
| **`items`**                     | 定义数组内元素的 Schema。可以是单个 Schema（所有元素相同）或数组（元组验证）。 | **列表定义**：定义一个包含 User 对象的列表。                           |
| **`minItems`** / **`maxItems`** | 数组长度限制。                                                                 | **数量限制**：购物车至少有 1 个商品，最多 100 个。                     |
| **`uniqueItems`**               | 布尔值，是否要求元素唯一。                                                     | **去重**：如标签（Tags）列表，不能包含重复标签。                       |
| **`contains`**                  | 数组中至少有一个元素匹配此 Schema。                                            | **存在性检查**：由管理员列表组成的数组中，必须包含至少一个 root 用户。 |

---

### 7. 逻辑组合与重用 (Logic & Reusability)

用于构建复杂的验证逻辑。

| 字段                             | 含义                                          | 使用场景                                                                           |
| :------------------------------- | :-------------------------------------------- | :--------------------------------------------------------------------------------- |
| **`$ref`**                       | 引用定义好的 Schema 片段。                    | **代码复用**：在多个地方引用同一个 Address 定义，减少重复。                        |
| **`definitions`** (或 `$defs`)   | 存放可复用 Schema 的容器，不会直接参与验证。  | **组件库**：定义 `address`, `user` 等基础模型供 `$ref` 调用。                      |
| **`allOf`**                      | 必须满足列表中的**所有** Schema（AND 逻辑）。 | **继承/组合**：验证数据既要是 Object，又要包含特定字段（常用于组合多个模型）。     |
| **`anyOf`**                      | 满足列表中**至少一个** Schema（OR 逻辑）。    | **多类型兼容**：字段既可以是字符串，也可以是数字（如 ID）。                        |
| **`oneOf`**                      | 满足列表中**恰好一个** Schema（XOR 逻辑）。   | **互斥逻辑**：支付方式只能是“信用卡”或“支付宝”结构中的一种，不能混用。             |
| **`not`**                        | 不能匹配该 Schema。                           | **黑名单**：字段类型不能是 String。                                                |
| **`if`**, **`then`**, **`else`** | 条件验证。                                    | **动态验证**：如果 `country` 是 "US"，则 `zipcode` 必须是 5 位数字；否则是字符串。 |

---

### 综合示例

下面是一个包含上述多种字段的 User 对象 Schema 示例：

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/user.schema.json",
  "title": "用户",
  "description": "用户注册信息的验证规则",
  "type": "object",
  "required": ["id", "username", "email"],
  "properties": {
    "id": {
      "type": "integer",
      "minimum": 1
    },
    "username": {
      "type": "string",
      "minLength": 4,
      "maxLength": 20,
      "pattern": "^[a-zA-Z0-9_]+$"
    },
    "email": {
      "type": "string",
      "format": "email"
    },
    "role": {
      "type": "string",
      "enum": ["admin", "editor", "viewer"],
      "default": "viewer"
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" },
      "uniqueItems": true
    },
    "contact_info": {
      "$ref": "#/definitions/address"
    }
  },
  "additionalProperties": false,
  "definitions": {
    "address": {
      "type": "object",
      "properties": {
        "city": { "type": "string" },
        "street": { "type": "string" }
      }
    }
  }
}
```

### 总结

- **基础字段** (`type`, `properties`, `required`)：决定了 JSON 的骨架。
- **约束字段** (`minLength`, `maximum`, `pattern`)：决定了数据的合法性范围。
- **逻辑字段** (`oneOf`, `$ref`, `if`)：赋予了 Schema 处理复杂业务逻辑和复用代码的能力。
